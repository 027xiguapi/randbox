---
title: "ä»é›¶å¼€å§‹æ‰“é€  RandBoxï¼šä¸€ä¸ªå¼ºå¤§çš„ JavaScript éšæœºæ•°æ®ç”Ÿæˆåº“ï¼ˆ4/5ï¼‰- æµ‹è¯•ä½“ç³»ä¸è´¨é‡ä¿è¯"
description: "RandBox é¡µé¢ï¼šä»é›¶å¼€å§‹æ‰“é€  RandBoxï¼šä¸€ä¸ªå¼ºå¤§çš„ JavaScript éšæœºæ•°æ®ç”Ÿæˆåº“ï¼ˆ4/5ï¼‰- æµ‹è¯•ä½“ç³»ä¸è´¨é‡ä¿è¯ï¼ŒåŒ…å«ç¤ºä¾‹ä¸è¯´æ˜ã€‚"
date: "2025-10-16"
tags: ["RandBox", "blog", "04-testing-system-and-quality-assurance"]
keywords: ["RandBox", "blog", "04-testing-system-and-quality-assurance", "éšæœº", "JavaScript", "MDX"]
---

# ä»é›¶å¼€å§‹æ‰“é€  RandBoxï¼šä¸€ä¸ªå¼ºå¤§çš„ JavaScript éšæœºæ•°æ®ç”Ÿæˆåº“ï¼ˆ4/5ï¼‰- æµ‹è¯•ä½“ç³»ä¸è´¨é‡ä¿è¯

## å‰è¨€

åœ¨å‰ä¸‰ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥æ¢è®¨äº† RandBox çš„è§„åˆ’ã€æ¶æ„å’ŒåŠŸèƒ½å®ç°ã€‚ä»Šå¤©ï¼Œæˆ‘å°†åˆ†äº«å¦‚ä½•ä¸º RandBox æ„å»ºå®Œå–„çš„æµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿åº“çš„è´¨é‡å’Œå¯é æ€§ã€‚å¯¹äºä¸€ä¸ªéšæœºæ•°æ®ç”Ÿæˆåº“è€Œè¨€ï¼Œæµ‹è¯•é¢ä¸´ç€ç‹¬ç‰¹çš„æŒ‘æˆ˜ï¼šå¦‚ä½•æµ‹è¯•"éšæœº"çš„ç»“æœï¼Ÿå¦‚ä½•ä¿è¯è·¨å¹³å°çš„ä¸€è‡´æ€§ï¼Ÿè¿™äº›é—®é¢˜éƒ½éœ€è¦å·§å¦™çš„è§£å†³æ–¹æ¡ˆã€‚

## æµ‹è¯•ç­–ç•¥è®¾è®¡

### æµ‹è¯•é‡‘å­—å¡”åŸåˆ™

RandBox çš„æµ‹è¯•ä½“ç³»éµå¾ªç»å…¸çš„æµ‹è¯•é‡‘å­—å¡”åŸåˆ™ï¼š

```
        /\
       /  \
      / E2E \ (å°‘é‡ç«¯åˆ°ç«¯æµ‹è¯•)
     /______\
    /        \
   / é›†æˆæµ‹è¯•  \ (ä¸­ç­‰æ•°é‡)
  /____________\
 /              \
/   å•å…ƒæµ‹è¯•      \ (å¤§é‡åŸºç¡€æµ‹è¯•)
/________________\
```

### æ ¸å¿ƒæµ‹è¯•æŒ‘æˆ˜

#### 1. **éšæœºæ€§æµ‹è¯•çš„æ‚–è®º**
éšæœºæ•°æ®ç”Ÿæˆçš„ç»“æœæœ¬è´¨ä¸Šæ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œä½†æµ‹è¯•éœ€è¦å¯é¢„æµ‹çš„æ–­è¨€ã€‚

**è§£å†³æ–¹æ¡ˆï¼šç§å­æ§åˆ¶**
```javascript
// ä½¿ç”¨å›ºå®šç§å­ç¡®ä¿æµ‹è¯•ç»“æœå¯é‡ç°
const randBox = new RandBox('test-seed-123');
assert(randBox.integer(1, 10) === 7); // åœ¨ç›¸åŒç§å­ä¸‹æ€»æ˜¯è¿”å›7
```

#### 2. **ç»Ÿè®¡æ€§è´¨éªŒè¯**
éœ€è¦éªŒè¯ç”Ÿæˆæ•°æ®çš„ç»Ÿè®¡ç‰¹æ€§æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

**è§£å†³æ–¹æ¡ˆï¼šå¤§æ•°å®šå¾‹**
```javascript
// ç”Ÿæˆå¤§é‡æ•°æ®éªŒè¯åˆ†å¸ƒç‰¹æ€§
test('integer distribution should be uniform', () => {
  const results = {};
  const iterations = 10000;

  for (let i = 0; i < iterations; i++) {
    const value = randBox.integer(1, 10);
    results[value] = (results[value] || 0) + 1;
  }

  // éªŒè¯æ¯ä¸ªæ•°å­—å‡ºç°é¢‘ç‡æ¥è¿‘æœŸæœ›å€¼
  Object.values(results).forEach(count => {
    const expected = iterations / 10;
    const tolerance = expected * 0.1; // 10% å®¹å·®
    assert(Math.abs(count - expected) < tolerance);
  });
});
```

## å•å…ƒæµ‹è¯•å®ç°

### 1. **åŸºç¡€åŠŸèƒ½æµ‹è¯•æ¡†æ¶**

é€‰æ‹© AVA ä½œä¸ºæµ‹è¯•æ¡†æ¶ï¼ŒåŸå› å¦‚ä¸‹ï¼š
- ç®€æ´çš„ API è®¾è®¡
- å†…ç½®å¹¶è¡Œæ‰§è¡Œ
- å¼ºå¤§çš„æ–­è¨€åº“
- ä¼˜ç§€çš„é”™è¯¯æŠ¥å‘Š

```javascript
// test/basics.test.js
import test from 'ava';
import RandBox from '../src/index.js';

test.beforeEach(t => {
  // æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç›¸åŒçš„ç§å­ç¡®ä¿å¯é‡ç°æ€§
  t.context.randBox = new RandBox('test-seed');
});

test('integer() should return number within range', t => {
  const { randBox } = t.context;

  for (let i = 0; i < 100; i++) {
    const result = randBox.integer(1, 10);
    t.true(Number.isInteger(result));
    t.true(result >= 1 && result <= 10);
  }
});

test('integer() with exclude option', t => {
  const { randBox } = t.context;
  const exclude = [5, 7, 9];

  for (let i = 0; i < 100; i++) {
    const result = randBox.integer({ min: 1, max: 10, exclude });
    t.false(exclude.includes(result));
  }
});
```

### 2. **å‚æ•°éªŒè¯æµ‹è¯•**

```javascript
test('integer() parameter validation', t => {
  const { randBox } = t.context;

  // æµ‹è¯•æ— æ•ˆå‚æ•°
  t.throws(() => randBox.integer('invalid'), {
    instanceOf: TypeError,
    message: /Expected number/
  });

  // æµ‹è¯•èŒƒå›´é”™è¯¯
  t.throws(() => randBox.integer(10, 5), {
    instanceOf: RangeError,
    message: /Min cannot be greater than max/
  });

  // æµ‹è¯•è¾¹ç•Œå€¼
  t.notThrows(() => randBox.integer(0, 0)); // åº”è¯¥æ€»æ˜¯è¿”å›0
  t.is(randBox.integer(0, 0), 0);
});
```

### 3. **å¤æ‚åŠŸèƒ½æµ‹è¯•**

```javascript
// æµ‹è¯•å§“åç”Ÿæˆ
test('name() should generate valid names', t => {
  const { randBox } = t.context;

  // ä¸­æ–‡å§“åæµ‹è¯•
  const chineseName = randBox.name({ nationality: 'zh' });
  t.true(typeof chineseName === 'string');
  t.true(chineseName.length >= 2 && chineseName.length <= 4);

  // è‹±æ–‡å§“åæµ‹è¯•
  const englishName = randBox.name({ nationality: 'en' });
  t.true(englishName.includes(' ')); // è‹±æ–‡ååŒ…å«ç©ºæ ¼

  // å¸¦å‰ç¼€çš„å§“å
  const nameWithPrefix = randBox.name({
    nationality: 'en',
    prefix: true,
    gender: 'male'
  });
  t.true(nameWithPrefix.startsWith('Mr.') || nameWithPrefix.startsWith('Dr.'));
});

// æµ‹è¯•é‚®ç®±ç”Ÿæˆ
test('email() should generate valid email addresses', t => {
  const { randBox } = t.context;

  const email = randBox.email();

  // åŸºæœ¬æ ¼å¼éªŒè¯
  t.regex(email, /^[^\s@]+@[^\s@]+\.[^\s@]+$/);

  // è‡ªå®šä¹‰åŸŸåæµ‹è¯•
  const customEmail = randBox.email({ domain: 'example.com' });
  t.true(customEmail.endsWith('@example.com'));
});
```

## æ€§èƒ½æµ‹è¯•ä¸åŸºå‡†æµ‹è¯•

### 1. **æ€§èƒ½æµ‹è¯•æ¡†æ¶æ­å»º**

```javascript
// test/performance.test.js
import { performance } from 'perf_hooks';
import test from 'ava';
import RandBox from '../src/index.js';

function benchmark(name, fn, iterations = 10000) {
  const start = performance.now();

  for (let i = 0; i < iterations; i++) {
    fn();
  }

  const end = performance.now();
  const duration = end - start;
  const opsPerSec = (iterations / duration) * 1000;

  console.log(`${name}: ${duration.toFixed(2)}ms (${opsPerSec.toFixed(0)} ops/sec)`);

  return { duration, opsPerSec };
}

test('performance benchmarks', t => {
  const randBox = new RandBox();

  // åŸºç¡€åŠŸèƒ½æ€§èƒ½æµ‹è¯•
  const integerPerf = benchmark('integer()', () => randBox.integer());
  const stringPerf = benchmark('string()', () => randBox.string());
  const namePerf = benchmark('name()', () => randBox.name());

  // æ€§èƒ½è¦æ±‚ï¼šæ¯ç§’è‡³å°‘å¤„ç†10000æ¬¡æ“ä½œ
  t.true(integerPerf.opsPerSec > 10000);
  t.true(stringPerf.opsPerSec > 5000);
  t.true(namePerf.opsPerSec > 1000);
});
```

### 2. **å†…å­˜ä½¿ç”¨æµ‹è¯•**

```javascript
test('memory usage should be reasonable', t => {
  const initialMemory = process.memoryUsage().heapUsed;

  // åˆ›å»ºå¤šä¸ªå®ä¾‹
  const instances = [];
  for (let i = 0; i < 1000; i++) {
    instances.push(new RandBox());
  }

  // ç”Ÿæˆå¤§é‡æ•°æ®
  instances.forEach(randBox => {
    for (let j = 0; j < 100; j++) {
      randBox.name();
      randBox.email();
      randBox.address();
    }
  });

  const finalMemory = process.memoryUsage().heapUsed;
  const memoryIncrease = finalMemory - initialMemory;

  // å†…å­˜å¢é•¿åº”è¯¥åœ¨åˆç†èŒƒå›´å†…ï¼ˆå°äº50MBï¼‰
  t.true(memoryIncrease < 50 * 1024 * 1024);
});
```

## ç»Ÿè®¡ç‰¹æ€§éªŒè¯

### 1. **éšæœºåˆ†å¸ƒæµ‹è¯•**

```javascript
// test/statistics.test.js
import test from 'ava';
import RandBox from '../src/index.js';

function chiSquareTest(observed, expected, significance = 0.05) {
  let chiSquare = 0;

  for (let i = 0; i < observed.length; i++) {
    const diff = observed[i] - expected[i];
    chiSquare += (diff * diff) / expected[i];
  }

  // ç®€åŒ–çš„å¡æ–¹æ£€éªŒï¼ˆå®é™…åº”ç”¨ä¸­éœ€è¦æŸ¥è¡¨ï¼‰
  const degreesOfFreedom = observed.length - 1;
  const critical = degreesOfFreedom * 2; // ç®€åŒ–é˜ˆå€¼

  return chiSquare < critical;
}

test('integer distribution should pass chi-square test', t => {
  const randBox = new RandBox();
  const buckets = new Array(10).fill(0);
  const iterations = 10000;

  for (let i = 0; i < iterations; i++) {
    const value = randBox.integer(0, 9);
    buckets[value]++;
  }

  const expected = new Array(10).fill(iterations / 10);
  const isUniform = chiSquareTest(buckets, expected);

  t.true(isUniform, 'Distribution should be approximately uniform');
});

test('floating point distribution', t => {
  const randBox = new RandBox();
  const samples = [];

  for (let i = 0; i < 1000; i++) {
    samples.push(randBox.floating(0, 1));
  }

  // éªŒè¯èŒƒå›´
  samples.forEach(sample => {
    t.true(sample >= 0 && sample <= 1);
  });

  // éªŒè¯å‡å€¼æ¥è¿‘0.5
  const mean = samples.reduce((sum, val) => sum + val, 0) / samples.length;
  t.true(Math.abs(mean - 0.5) < 0.05);
});
```

### 2. **æ­£æ€åˆ†å¸ƒæµ‹è¯•**

```javascript
test('normal distribution should have correct properties', t => {
  const randBox = new RandBox();
  const samples = [];
  const mean = 100;
  const stdDev = 15;

  for (let i = 0; i < 1000; i++) {
    samples.push(randBox.normal(mean, stdDev));
  }

  // è®¡ç®—æ ·æœ¬å‡å€¼å’Œæ ‡å‡†å·®
  const sampleMean = samples.reduce((sum, val) => sum + val, 0) / samples.length;
  const variance = samples.reduce((sum, val) => sum + Math.pow(val - sampleMean, 2), 0) / samples.length;
  const sampleStdDev = Math.sqrt(variance);

  // éªŒè¯å‡å€¼å’Œæ ‡å‡†å·®åœ¨åˆç†èŒƒå›´å†…
  t.true(Math.abs(sampleMean - mean) < 2);
  t.true(Math.abs(sampleStdDev - stdDev) < 2);
});
```

## å…¼å®¹æ€§æµ‹è¯•

### 1. **å¤šç¯å¢ƒæµ‹è¯•**

```javascript
// test/compatibility.test.js
test('should work in different JavaScript environments', t => {
  // Node.js ç¯å¢ƒæµ‹è¯•
  if (typeof window === 'undefined') {
    t.true(true, 'Running in Node.js environment');
  }

  // æµ‹è¯• ES6 æ¨¡å—å¯¼å…¥
  t.truthy(RandBox);
  t.true(typeof RandBox === 'function');

  // æµ‹è¯•åŸºæœ¬åŠŸèƒ½
  const randBox = new RandBox();
  t.true(typeof randBox.random === 'function');
});

// æµè§ˆå™¨ç¯å¢ƒæµ‹è¯•ï¼ˆä½¿ç”¨ Puppeteerï¼‰
test('browser compatibility', async t => {
  const puppeteer = require('puppeteer');
  const browser = await puppeteer.launch();
  const page = await browser.newPage();

  await page.addScriptTag({
    path: './dist/index.umd.js'
  });

  const result = await page.evaluate(() => {
    const randBox = new window.RandBox();
    return {
      integer: randBox.integer(1, 10),
      string: randBox.string(),
      name: randBox.name()
    };
  });

  t.true(typeof result.integer === 'number');
  t.true(typeof result.string === 'string');
  t.true(typeof result.name === 'string');

  await browser.close();
});
```

### 2. **TypeScript ç±»å‹æµ‹è¯•**

```typescript
// test/types.test.ts
import test from 'ava';
import RandBox from '../src/index';

test('TypeScript type definitions', t => {
  const randBox = new RandBox();

  // ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
  const num: number = randBox.integer();
  const str: string = randBox.string();
  const bool: boolean = randBox.bool();

  // å¯é€‰å‚æ•°ç±»å‹æ£€æŸ¥
  const customInt: number = randBox.integer({ min: 1, max: 10, exclude: [5] });
  const customStr: string = randBox.string({ length: 20, alpha: true });

  t.true(typeof num === 'number');
  t.true(typeof str === 'string');
  t.true(typeof bool === 'boolean');
});
```

## æŒç»­é›†æˆé…ç½®

### 1. **GitHub Actions å·¥ä½œæµ**

```yaml
# .github/workflows/test.yml
name: Test Suite

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        node-version: [16.x, 18.x, 20.x]

    steps:
    - uses: actions/checkout@v3

    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v3
      with:
        node-version: ${{ matrix.node-version }}
        cache: 'npm'

    - name: Install dependencies
      run: npm ci

    - name: Run linting
      run: npm run lint

    - name: Run type checking
      run: npm run typecheck

    - name: Run tests
      run: npm test

    - name: Run coverage
      run: npm run coverage

    - name: Upload coverage to Codecov
      uses: codecov/codecov-action@v3

  browser-test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: Install dependencies
      run: npm ci

    - name: Build for browser
      run: npm run build

    - name: Run browser tests
      run: npm run test:browser
```

### 2. **æµ‹è¯•è¦†ç›–ç‡é…ç½®**

```javascript
// nyc.config.js
module.exports = {
  include: ['src/**/*.ts'],
  exclude: [
    'src/**/*.test.ts',
    'src/**/*.spec.ts',
    'src/types.ts'
  ],
  reporter: ['text', 'html', 'lcov'],
  'report-dir': './coverage',
  'temp-dir': './coverage/.nyc_output',
  checkCoverage: true,
  lines: 90,
  statements: 90,
  functions: 90,
  branches: 85
};
```

## è´¨é‡ä¿è¯æµç¨‹

### 1. **ä»£ç è´¨é‡æ£€æŸ¥**

```javascript
// .eslintrc.js
module.exports = {
  extends: [
    '@typescript-eslint/recommended',
    'plugin:jest/recommended'
  ],
  rules: {
    // è‡ªå®šä¹‰è§„åˆ™
    'prefer-const': 'error',
    'no-var': 'error',
    '@typescript-eslint/explicit-function-return-type': 'warn',
    '@typescript-eslint/no-explicit-any': 'error'
  }
};
```

### 2. **è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹**

```json
{
  "scripts": {
    "preversion": "npm run test && npm run build",
    "version": "npm run docs:build",
    "postversion": "git push && git push --tags",
    "prepublishOnly": "npm run test && npm run build",
    "release": "semantic-release"
  }
}
```

### 3. **å˜æ›´æ—¥å¿—è‡ªåŠ¨ç”Ÿæˆ**

```javascript
// release.config.js
module.exports = {
  branches: ['main'],
  plugins: [
    '@semantic-release/commit-analyzer',
    '@semantic-release/release-notes-generator',
    '@semantic-release/changelog',
    '@semantic-release/npm',
    '@semantic-release/github'
  ]
};
```

## æµ‹è¯•æ•°æ®ç®¡ç†

### 1. **æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨**

```javascript
// test/helpers/test-data-generator.js
export class TestDataGenerator {
  static generateTestCases(count = 100) {
    const cases = [];

    for (let i = 0; i < count; i++) {
      cases.push({
        seed: `test-${i}`,
        expected: {
          integer: this.expectedInteger(`test-${i}`),
          string: this.expectedString(`test-${i}`),
          name: this.expectedName(`test-${i}`)
        }
      });
    }

    return cases;
  }

  static expectedInteger(seed) {
    // åŸºäºç§å­é¢„è®¡ç®—æœŸæœ›å€¼
    const randBox = new RandBox(seed);
    return randBox.integer(1, 100);
  }
}
```

### 2. **å¿«ç…§æµ‹è¯•**

```javascript
test('output consistency snapshot test', t => {
  const randBox = new RandBox('snapshot-seed');

  const output = {
    integers: Array(10).fill().map(() => randBox.integer(1, 100)),
    strings: Array(5).fill().map(() => randBox.string({ length: 10 })),
    names: Array(5).fill().map(() => randBox.name()),
    emails: Array(5).fill().map(() => randBox.email())
  };

  t.snapshot(output, 'Random output should be consistent');
});
```

## ä¸‹æœŸé¢„å‘Š

åœ¨æœ€åä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†åˆ†äº« RandBox çš„æ–‡æ¡£å»ºè®¾ã€ç¤¾åŒºè¿è¥å’Œç”Ÿæ€å‘å±•ï¼ŒåŒ…æ‹¬ï¼š

- ç°ä»£åŒ–æ–‡æ¡£ç½‘ç«™çš„æ„å»º
- API æ–‡æ¡£çš„è‡ªåŠ¨ç”Ÿæˆ
- ç¤¾åŒºè´¡çŒ®æŒ‡å—çš„åˆ¶å®š
- æ’ä»¶ç”Ÿæ€çš„è§„åˆ’ä¸å®ç°

æ•¬è¯·æœŸå¾…ã€Šä»é›¶å¼€å§‹æ‰“é€  RandBoxï¼ˆ5/5ï¼‰- æ–‡æ¡£å»ºè®¾ä¸ç”Ÿæ€å‘å±•ã€‹ï¼

---

## å…³äº RandBox

**ğŸ  å®˜ç½‘**: [https://randbox.top](https://randbox.top)
**ğŸ“¦ GitHub**: [https://github.com/027xiguapi/randbox](https://github.com/027xiguapi/randbox)
**ğŸ“š æ–‡æ¡£**: [https://randbox.top/zh/docs](https://randbox.top/zh/docs)

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç»™æˆ‘ä»¬ä¸€ä¸ª â­ Starï¼